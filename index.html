<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Customizable Employee Board</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary-color: #3498db;
            --secondary-color: #2c3e50;
            --accent-color: #e74c3c;
            --success-color: #27ae60;
            --warning-color: #f39c12;
            --bg-gradient: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            --card-bg: rgba(255, 255, 255, 0.95);
            --text-primary: #2c3e50;
            --text-secondary: #7f8c8d;
        }

        body {
            background: var(--bg-gradient);
            min-height: 100vh;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            color: var(--text-primary);
        }

        /* ==================== HEADER ==================== */
        .header {
            background: rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(10px);
            padding: 15px 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .logo-icon {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 18px;
        }

        .company-name {
            color: white;
            font-size: 24px;
            font-weight: 600;
            cursor: pointer;
            user-select: none;
        }

        .company-name:hover {
            opacity: 0.9;
        }

        .header-actions {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .view-toggle {
            display: flex;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            overflow: hidden;
        }

        .view-btn {
            padding: 8px 16px;
            background: transparent;
            border: none;
            color: white;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 14px;
        }

        .view-btn.active {
            background: var(--primary-color);
        }

        .view-btn:hover:not(.active) {
            background: rgba(255, 255, 255, 0.1);
        }

        /* Hidden Admin Button - appears as subtle icon */
        .admin-toggle {
            width: 36px;
            height: 36px;
            background: transparent;
            border: 2px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            color: rgba(255, 255, 255, 0.4);
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
        }

        .admin-toggle:hover {
            border-color: rgba(255, 255, 255, 0.5);
            color: rgba(255, 255, 255, 0.7);
        }

        .admin-toggle.active {
            background: var(--accent-color);
            border-color: var(--accent-color);
            color: white;
        }

        /* ==================== MAIN CONTAINER ==================== */
        .main-container {
            display: flex;
            min-height: calc(100vh - 70px);
        }

        /* ==================== ADMIN SIDEBAR ==================== */
        .admin-sidebar {
            width: 0;
            background: rgba(0, 0, 0, 0.4);
            backdrop-filter: blur(10px);
            overflow: hidden;
            transition: width 0.3s ease;
            flex-shrink: 0;
        }

        .admin-sidebar.open {
            width: 320px;
        }

        .sidebar-content {
            width: 320px;
            padding: 20px;
            height: calc(100vh - 70px);
            overflow-y: auto;
        }

        .sidebar-section {
            margin-bottom: 25px;
        }

        .sidebar-title {
            color: white;
            font-size: 14px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 15px;
            padding-bottom: 8px;
            border-bottom: 2px solid rgba(255, 255, 255, 0.2);
        }

        .admin-btn {
            width: 100%;
            padding: 12px 15px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            color: white;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 14px;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .admin-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateX(5px);
        }

        .admin-btn.danger {
            border-color: var(--accent-color);
        }

        .admin-btn.danger:hover {
            background: rgba(231, 76, 60, 0.3);
        }

        .admin-btn.success {
            border-color: var(--success-color);
        }

        .admin-btn.success:hover {
            background: rgba(39, 174, 96, 0.3);
        }

        /* Department List in Sidebar */
        .dept-list {
            max-height: 200px;
            overflow-y: auto;
        }

        .dept-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 8px 12px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 6px;
            margin-bottom: 5px;
            color: white;
        }

        .dept-item-left {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .dept-color-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
        }

        .dept-item-actions {
            display: flex;
            gap: 5px;
        }

        .dept-item-btn {
            width: 24px;
            height: 24px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
        }

        .dept-item-btn.edit {
            background: var(--primary-color);
            color: white;
        }

        .dept-item-btn.delete {
            background: var(--accent-color);
            color: white;
        }

        .dept-item-btn:hover {
            transform: scale(1.1);
        }

        /* Stats */
        .stats-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }

        .stat-card {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            padding: 15px;
            text-align: center;
        }

        .stat-number {
            font-size: 28px;
            font-weight: bold;
            color: white;
        }

        .stat-label {
            font-size: 11px;
            color: rgba(255, 255, 255, 0.7);
            text-transform: uppercase;
        }

        /* ==================== CONTENT AREA ==================== */
        .content-area {
            flex: 1;
            padding: 30px;
            overflow-y: auto;
        }

        /* ==================== HIERARCHY VIEW ==================== */
        .hierarchy-view {
            display: none;
        }

        .hierarchy-view.active {
            display: block;
        }

        .hierarchy-level {
            margin-bottom: 40px;
        }

        .level-title {
            color: white;
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 20px;
            padding: 10px 20px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 8px;
            display: inline-block;
        }

        .level-cards {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            justify-content: center;
        }

        /* ==================== GRID VIEW ==================== */
        .grid-view {
            display: none;
        }

        .grid-view.active {
            display: block;
        }

        .filter-bar {
            display: flex;
            gap: 15px;
            margin-bottom: 25px;
            flex-wrap: wrap;
        }

        .search-box {
            flex: 1;
            min-width: 200px;
            padding: 12px 20px;
            border: 2px solid rgba(255, 255, 255, 0.2);
            border-radius: 10px;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            font-size: 14px;
        }

        .search-box::placeholder {
            color: rgba(255, 255, 255, 0.5);
        }

        .search-box:focus {
            outline: none;
            border-color: var(--primary-color);
        }

        .filter-select {
            padding: 12px 20px;
            border: 2px solid rgba(255, 255, 255, 0.2);
            border-radius: 10px;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            font-size: 14px;
            cursor: pointer;
            min-width: 150px;
        }

        .filter-select option {
            background: var(--secondary-color);
            color: white;
        }

        .employees-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 20px;
        }

        /* ==================== EMPLOYEE CARD ==================== */
        .employee-card {
            background: var(--card-bg);
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            transition: all 0.3s ease;
            border-left: 4px solid var(--primary-color);
            position: relative;
        }

        .employee-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
        }

        .employee-card.admin-mode::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            border: 2px dashed var(--primary-color);
            border-radius: 12px;
            pointer-events: none;
            opacity: 0.5;
        }

        .card-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 15px;
        }

        .card-photo {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            object-fit: cover;
            background: linear-gradient(135deg, #bdc3c7, #ecf0f1);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            font-weight: bold;
            color: var(--text-secondary);
        }

        .card-info {
            flex: 1;
        }

        .card-name {
            font-size: 16px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 4px;
        }

        .card-position {
            font-size: 13px;
            color: var(--text-secondary);
        }

        .card-details {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .card-detail {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 13px;
            color: var(--text-secondary);
        }

        .card-detail-icon {
            width: 20px;
            text-align: center;
        }

        .dept-badge {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 11px;
            font-weight: 600;
            color: white;
        }

        .card-actions {
            display: none;
            position: absolute;
            top: 10px;
            right: 10px;
            gap: 5px;
        }

        .admin-mode .card-actions {
            display: flex;
        }

        .card-action-btn {
            width: 30px;
            height: 30px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.2s;
        }

        .card-action-btn.edit {
            background: var(--primary-color);
            color: white;
        }

        .card-action-btn.delete {
            background: var(--accent-color);
            color: white;
        }

        .card-action-btn:hover {
            transform: scale(1.1);
        }

        /* ==================== DEPARTMENT VIEW ==================== */
        .department-view {
            display: none;
        }

        .department-view.active {
            display: block;
        }

        .dept-cards-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
        }

        .dept-card {
            background: var(--card-bg);
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            transition: all 0.3s ease;
            cursor: pointer;
            text-align: center;
            border-top: 4px solid var(--primary-color);
        }

        .dept-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
        }

        .dept-card-icon {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            margin: 0 auto 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            color: white;
        }

        .dept-card-name {
            font-size: 18px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 5px;
        }

        .dept-card-count {
            font-size: 14px;
            color: var(--text-secondary);
        }

        /* ==================== MODALS ==================== */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.7);
            z-index: 2000;
            align-items: center;
            justify-content: center;
            backdrop-filter: blur(5px);
        }

        .modal-overlay.active {
            display: flex;
        }

        .modal {
            background: white;
            border-radius: 16px;
            padding: 30px;
            max-width: 500px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
        }

        .modal-title {
            font-size: 22px;
            font-weight: 600;
            color: var(--text-primary);
        }

        .modal-close {
            width: 36px;
            height: 36px;
            border: none;
            background: #f1f2f6;
            border-radius: 50%;
            cursor: pointer;
            font-size: 18px;
            color: var(--text-secondary);
            transition: all 0.2s;
        }

        .modal-close:hover {
            background: var(--accent-color);
            color: white;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            font-size: 14px;
            font-weight: 500;
            color: var(--text-primary);
            margin-bottom: 8px;
        }

        .form-input {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 14px;
            transition: border-color 0.3s;
        }

        .form-input:focus {
            outline: none;
            border-color: var(--primary-color);
        }

        .form-select {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 14px;
            cursor: pointer;
            background: white;
        }

        .form-select:focus {
            outline: none;
            border-color: var(--primary-color);
        }

        .color-picker-wrapper {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .color-picker {
            width: 50px;
            height: 40px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
        }

        .color-preview {
            flex: 1;
            height: 40px;
            border-radius: 8px;
            border: 2px solid #e0e0e0;
        }

        .form-actions {
            display: flex;
            gap: 10px;
            justify-content: flex-end;
            margin-top: 25px;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-primary {
            background: var(--primary-color);
            color: white;
        }

        .btn-primary:hover {
            background: #2980b9;
        }

        .btn-secondary {
            background: #e0e0e0;
            color: var(--text-primary);
        }

        .btn-secondary:hover {
            background: #d0d0d0;
        }

        .btn-danger {
            background: var(--accent-color);
            color: white;
        }

        .btn-danger:hover {
            background: #c0392b;
        }

        .btn-success {
            background: var(--success-color);
            color: white;
        }

        .btn-success:hover {
            background: #219a52;
        }

        /* ==================== SETTINGS MODAL ==================== */
        .settings-group {
            margin-bottom: 20px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 10px;
        }

        .settings-group-title {
            font-size: 14px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 15px;
        }

        /* ==================== EMPTY STATE ==================== */
        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: white;
        }

        .empty-state-icon {
            font-size: 64px;
            margin-bottom: 20px;
            opacity: 0.5;
        }

        .empty-state-title {
            font-size: 24px;
            font-weight: 600;
            margin-bottom: 10px;
        }

        .empty-state-text {
            font-size: 16px;
            opacity: 0.7;
            margin-bottom: 20px;
        }

        /* ==================== TOAST NOTIFICATIONS ==================== */
        .toast-container {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 3000;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .toast {
            padding: 15px 20px;
            border-radius: 10px;
            color: white;
            font-size: 14px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            animation: slideIn 0.3s ease;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .toast.success {
            background: var(--success-color);
        }

        .toast.error {
            background: var(--accent-color);
        }

        .toast.info {
            background: var(--primary-color);
        }

        @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        /* ==================== CONFIRM DIALOG ==================== */
        .confirm-dialog {
            text-align: center;
        }

        .confirm-icon {
            font-size: 48px;
            margin-bottom: 15px;
        }

        .confirm-message {
            font-size: 16px;
            color: var(--text-secondary);
            margin-bottom: 25px;
        }

        /* ==================== RESPONSIVE ==================== */
        @media (max-width: 768px) {
            .header {
                padding: 10px 15px;
            }

            .company-name {
                font-size: 18px;
            }

            .admin-sidebar.open {
                position: fixed;
                top: 70px;
                left: 0;
                bottom: 0;
                width: 100%;
                z-index: 999;
            }

            .sidebar-content {
                width: 100%;
            }

            .content-area {
                padding: 15px;
            }

            .employees-grid {
                grid-template-columns: 1fr;
            }

            .filter-bar {
                flex-direction: column;
            }

            .search-box, .filter-select {
                width: 100%;
            }
        }

        /* ==================== HIERARCHY TREE ==================== */
        .hierarchy-tree {
            padding: 20px;
        }

        .tree-node {
            position: relative;
            padding-left: 30px;
        }

        .tree-node::before {
            content: '';
            position: absolute;
            left: 10px;
            top: 0;
            bottom: 50%;
            width: 2px;
            background: rgba(255, 255, 255, 0.3);
        }

        .tree-node::after {
            content: '';
            position: absolute;
            left: 10px;
            top: 50%;
            width: 15px;
            height: 2px;
            background: rgba(255, 255, 255, 0.3);
        }

        .tree-node:first-child::before {
            top: 50%;
        }

        .tree-node:last-child::before {
            bottom: 50%;
        }

        .tree-root {
            padding-left: 0;
        }

        .tree-root::before, .tree-root::after {
            display: none;
        }

        .tree-card {
            background: var(--card-bg);
            border-radius: 10px;
            padding: 12px 15px;
            margin: 8px 0;
            display: inline-flex;
            align-items: center;
            gap: 12px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
            border-left: 3px solid var(--primary-color);
        }

        .tree-card-photo {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: linear-gradient(135deg, #bdc3c7, #ecf0f1);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: var(--text-secondary);
        }

        .tree-card-info {
            display: flex;
            flex-direction: column;
        }

        .tree-card-name {
            font-weight: 600;
            font-size: 14px;
            color: var(--text-primary);
        }

        .tree-card-position {
            font-size: 12px;
            color: var(--text-secondary);
        }

        .tree-children {
            margin-left: 20px;
        }

        /* ==================== IMPORT/EXPORT ==================== */
        .file-input-wrapper {
            position: relative;
            overflow: hidden;
            display: inline-block;
            width: 100%;
        }

        .file-input {
            position: absolute;
            left: 0;
            top: 0;
            opacity: 0;
            cursor: pointer;
            width: 100%;
            height: 100%;
        }

        .file-input-label {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            padding: 15px;
            background: rgba(255, 255, 255, 0.1);
            border: 2px dashed rgba(255, 255, 255, 0.3);
            border-radius: 10px;
            color: white;
            cursor: pointer;
            transition: all 0.3s;
        }

        .file-input-label:hover {
            background: rgba(255, 255, 255, 0.2);
            border-color: rgba(255, 255, 255, 0.5);
        }
    </style>
</head>
<body>
    <!-- HEADER -->
    <header class="header">
        <div class="logo">
            <div class="logo-icon">EB</div>
            <h1 class="company-name" id="companyName" title="Click 5 times to toggle admin mode">Employee Board</h1>
        </div>
        <div class="header-actions">
            <div class="view-toggle">
                <button class="view-btn active" data-view="grid">Grid</button>
                <button class="view-btn" data-view="hierarchy">Hierarchy</button>
                <button class="view-btn" data-view="departments">Departments</button>
            </div>
            <button class="admin-toggle" id="adminToggle" title="Admin Panel (Ctrl+Shift+A)">‚öô</button>
        </div>
    </header>

    <!-- MAIN CONTAINER -->
    <div class="main-container">
        <!-- ADMIN SIDEBAR -->
        <aside class="admin-sidebar" id="adminSidebar">
            <div class="sidebar-content">
                <!-- Stats Section -->
                <div class="sidebar-section">
                    <h3 class="sidebar-title">Overview</h3>
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-number" id="totalEmployees">0</div>
                            <div class="stat-label">Employees</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="totalDepartments">0</div>
                            <div class="stat-label">Departments</div>
                        </div>
                    </div>
                </div>

                <!-- Employee Management -->
                <div class="sidebar-section">
                    <h3 class="sidebar-title">Employees</h3>
                    <button class="admin-btn success" onclick="openEmployeeModal()">
                        <span>+</span> Add Employee
                    </button>
                </div>

                <!-- Department Management -->
                <div class="sidebar-section">
                    <h3 class="sidebar-title">Departments</h3>
                    <button class="admin-btn success" onclick="openDepartmentModal()">
                        <span>+</span> Add Department
                    </button>
                    <div class="dept-list" id="deptList"></div>
                </div>

                <!-- Data Management -->
                <div class="sidebar-section">
                    <h3 class="sidebar-title">Data Management</h3>
                    <button class="admin-btn" onclick="exportData()">
                        <span>‚Üì</span> Export Data (JSON)
                    </button>
                    <div class="file-input-wrapper">
                        <input type="file" class="file-input" id="importFile" accept=".json" onchange="importData(event)">
                        <label class="file-input-label">
                            <span>‚Üë</span> Import Data (JSON)
                        </label>
                    </div>
                </div>

                <!-- Settings -->
                <div class="sidebar-section">
                    <h3 class="sidebar-title">Settings</h3>
                    <button class="admin-btn" onclick="openSettingsModal()">
                        <span>‚öô</span> Board Settings
                    </button>
                    <button class="admin-btn danger" onclick="confirmReset()">
                        <span>‚ü≤</span> Reset to Default
                    </button>
                </div>
            </div>
        </aside>

        <!-- CONTENT AREA -->
        <main class="content-area">
            <!-- Grid View -->
            <div class="grid-view active" id="gridView">
                <div class="filter-bar">
                    <input type="text" class="search-box" id="searchBox" placeholder="Search employees...">
                    <select class="filter-select" id="deptFilter">
                        <option value="">All Departments</option>
                    </select>
                    <select class="filter-select" id="positionFilter">
                        <option value="">All Positions</option>
                    </select>
                </div>
                <div class="employees-grid" id="employeesGrid"></div>
            </div>

            <!-- Hierarchy View -->
            <div class="hierarchy-view" id="hierarchyView">
                <div class="hierarchy-tree" id="hierarchyTree"></div>
            </div>

            <!-- Department View -->
            <div class="department-view" id="departmentView">
                <div class="dept-cards-grid" id="deptCardsGrid"></div>
            </div>
        </main>
    </div>

    <!-- MODALS -->
    <!-- Employee Modal -->
    <div class="modal-overlay" id="employeeModal">
        <div class="modal">
            <div class="modal-header">
                <h2 class="modal-title" id="employeeModalTitle">Add Employee</h2>
                <button class="modal-close" onclick="closeEmployeeModal()">√ó</button>
            </div>
            <form id="employeeForm" onsubmit="saveEmployee(event)">
                <input type="hidden" id="employeeId">
                <div class="form-group">
                    <label class="form-label">Full Name *</label>
                    <input type="text" class="form-input" id="employeeName" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Position *</label>
                    <input type="text" class="form-input" id="employeePosition" required placeholder="e.g., Manager, Supervisor, Employee">
                </div>
                <div class="form-group">
                    <label class="form-label">Department *</label>
                    <select class="form-select" id="employeeDepartment" required>
                        <option value="">Select Department</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">Reports To</label>
                    <select class="form-select" id="employeeManager">
                        <option value="">None (Top Level)</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">Shift</label>
                    <input type="text" class="form-input" id="employeeShift" placeholder="e.g., 1st Shift, Day Shift">
                </div>
                <div class="form-group">
                    <label class="form-label">Email</label>
                    <input type="email" class="form-input" id="employeeEmail">
                </div>
                <div class="form-group">
                    <label class="form-label">Phone</label>
                    <input type="tel" class="form-input" id="employeePhone">
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeEmployeeModal()">Cancel</button>
                    <button type="submit" class="btn btn-primary">Save Employee</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Department Modal -->
    <div class="modal-overlay" id="departmentModal">
        <div class="modal">
            <div class="modal-header">
                <h2 class="modal-title" id="departmentModalTitle">Add Department</h2>
                <button class="modal-close" onclick="closeDepartmentModal()">√ó</button>
            </div>
            <form id="departmentForm" onsubmit="saveDepartment(event)">
                <input type="hidden" id="departmentId">
                <div class="form-group">
                    <label class="form-label">Department Name *</label>
                    <input type="text" class="form-input" id="departmentName" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Department Color</label>
                    <div class="color-picker-wrapper">
                        <input type="color" class="color-picker" id="departmentColor" value="#3498db" onchange="updateColorPreview()">
                        <div class="color-preview" id="colorPreview" style="background: #3498db;"></div>
                    </div>
                </div>
                <div class="form-group">
                    <label class="form-label">Description</label>
                    <input type="text" class="form-input" id="departmentDescription" placeholder="Brief description of the department">
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeDepartmentModal()">Cancel</button>
                    <button type="submit" class="btn btn-primary">Save Department</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Settings Modal -->
    <div class="modal-overlay" id="settingsModal">
        <div class="modal">
            <div class="modal-header">
                <h2 class="modal-title">Board Settings</h2>
                <button class="modal-close" onclick="closeSettingsModal()">√ó</button>
            </div>
            <form id="settingsForm" onsubmit="saveSettings(event)">
                <div class="settings-group">
                    <div class="settings-group-title">Company Information</div>
                    <div class="form-group">
                        <label class="form-label">Company Name</label>
                        <input type="text" class="form-input" id="settingsCompanyName">
                    </div>
                </div>
                <div class="settings-group">
                    <div class="settings-group-title">Position Hierarchy</div>
                    <div class="form-group">
                        <label class="form-label">Position Levels (comma separated, highest to lowest)</label>
                        <input type="text" class="form-input" id="settingsPositions" placeholder="Director, Manager, Supervisor, Lead, Employee">
                    </div>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeSettingsModal()">Cancel</button>
                    <button type="submit" class="btn btn-primary">Save Settings</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Confirm Modal -->
    <div class="modal-overlay" id="confirmModal">
        <div class="modal">
            <div class="confirm-dialog">
                <div class="confirm-icon" id="confirmIcon">‚ö†Ô∏è</div>
                <h2 class="modal-title" id="confirmTitle">Confirm Action</h2>
                <p class="confirm-message" id="confirmMessage">Are you sure you want to proceed?</p>
                <div class="form-actions" style="justify-content: center;">
                    <button type="button" class="btn btn-secondary" onclick="closeConfirmModal()">Cancel</button>
                    <button type="button" class="btn btn-danger" id="confirmBtn">Confirm</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Toast Container -->
    <div class="toast-container" id="toastContainer"></div>

    <script>
        // ==================== DATA STORE ====================
        const STORAGE_KEY = 'customEmployeeBoard';

        let appData = {
            settings: {
                companyName: 'Employee Board',
                positionLevels: ['Director', 'Manager', 'Supervisor', 'Lead', 'Specialist', 'Employee', 'Associate']
            },
            departments: [],
            employees: []
        };

        // ==================== DEFAULT DATA ====================
        const defaultData = {
            settings: {
                companyName: 'Employee Board',
                positionLevels: ['Director', 'Manager', 'Supervisor', 'Lead', 'Specialist', 'Employee', 'Associate']
            },
            departments: [
                { id: 1, name: 'Management', color: '#f39c12', description: 'Executive leadership' },
                { id: 2, name: 'Engineering', color: '#3498db', description: 'Software development' },
                { id: 3, name: 'Marketing', color: '#9b59b6', description: 'Marketing and communications' },
                { id: 4, name: 'Sales', color: '#27ae60', description: 'Sales and business development' },
                { id: 5, name: 'Operations', color: '#e74c3c', description: 'Operations and logistics' },
                { id: 6, name: 'Human Resources', color: '#1abc9c', description: 'HR and recruitment' }
            ],
            employees: [
                { id: 1, name: 'John Smith', position: 'Director', department: 'Management', parentId: null, shift: '', email: 'john@company.com', phone: '' },
                { id: 2, name: 'Sarah Johnson', position: 'Manager', department: 'Engineering', parentId: 1, shift: '', email: 'sarah@company.com', phone: '' },
                { id: 3, name: 'Mike Brown', position: 'Manager', department: 'Marketing', parentId: 1, shift: '', email: 'mike@company.com', phone: '' },
                { id: 4, name: 'Emily Davis', position: 'Manager', department: 'Sales', parentId: 1, shift: '', email: 'emily@company.com', phone: '' },
                { id: 5, name: 'David Wilson', position: 'Supervisor', department: 'Engineering', parentId: 2, shift: 'Day Shift', email: '', phone: '' },
                { id: 6, name: 'Lisa Anderson', position: 'Supervisor', department: 'Engineering', parentId: 2, shift: 'Night Shift', email: '', phone: '' },
                { id: 7, name: 'James Taylor', position: 'Lead', department: 'Marketing', parentId: 3, shift: '', email: '', phone: '' },
                { id: 8, name: 'Jennifer Martinez', position: 'Employee', department: 'Engineering', parentId: 5, shift: 'Day Shift', email: '', phone: '' },
                { id: 9, name: 'Robert Garcia', position: 'Employee', department: 'Engineering', parentId: 5, shift: 'Day Shift', email: '', phone: '' },
                { id: 10, name: 'Amanda Lee', position: 'Employee', department: 'Marketing', parentId: 7, shift: '', email: '', phone: '' }
            ]
        };

        // ==================== INITIALIZATION ====================
        function init() {
            loadData();
            renderAll();
            setupEventListeners();
            updateStats();
        }

        function loadData() {
            const saved = localStorage.getItem(STORAGE_KEY);
            if (saved) {
                try {
                    appData = JSON.parse(saved);
                } catch (e) {
                    console.error('Error loading data:', e);
                    appData = JSON.parse(JSON.stringify(defaultData));
                }
            } else {
                appData = JSON.parse(JSON.stringify(defaultData));
            }
            document.getElementById('companyName').textContent = appData.settings.companyName;
        }

        function saveData() {
            localStorage.setItem(STORAGE_KEY, JSON.stringify(appData));
            updateStats();
        }

        function renderAll() {
            renderEmployeesGrid();
            renderHierarchyTree();
            renderDepartmentCards();
            renderDeptList();
            populateDepartmentSelects();
            populateManagerSelect();
            populateFilterSelects();
        }

        // ==================== EVENT LISTENERS ====================
        function setupEventListeners() {
            // View toggle
            document.querySelectorAll('.view-btn').forEach(btn => {
                btn.addEventListener('click', () => switchView(btn.dataset.view));
            });

            // Admin toggle
            document.getElementById('adminToggle').addEventListener('click', toggleAdminPanel);

            // Secret admin toggle (click company name 5 times)
            let clickCount = 0;
            let clickTimer;
            document.getElementById('companyName').addEventListener('click', () => {
                clickCount++;
                clearTimeout(clickTimer);
                clickTimer = setTimeout(() => clickCount = 0, 2000);
                if (clickCount >= 5) {
                    toggleAdminPanel();
                    clickCount = 0;
                }
            });

            // Keyboard shortcut (Ctrl+Shift+A)
            document.addEventListener('keydown', (e) => {
                if (e.ctrlKey && e.shiftKey && e.key === 'A') {
                    e.preventDefault();
                    toggleAdminPanel();
                }
            });

            // Search and filter
            document.getElementById('searchBox').addEventListener('input', filterEmployees);
            document.getElementById('deptFilter').addEventListener('change', filterEmployees);
            document.getElementById('positionFilter').addEventListener('change', filterEmployees);

            // Close modals on overlay click
            document.querySelectorAll('.modal-overlay').forEach(overlay => {
                overlay.addEventListener('click', (e) => {
                    if (e.target === overlay) {
                        overlay.classList.remove('active');
                    }
                });
            });

            // ESC key to close modals
            document.addEventListener('keydown', (e) => {
                if (e.key === 'Escape') {
                    document.querySelectorAll('.modal-overlay.active').forEach(m => m.classList.remove('active'));
                }
            });
        }

        // ==================== VIEW SWITCHING ====================
        function switchView(view) {
            document.querySelectorAll('.view-btn').forEach(btn => {
                btn.classList.toggle('active', btn.dataset.view === view);
            });

            document.getElementById('gridView').classList.toggle('active', view === 'grid');
            document.getElementById('hierarchyView').classList.toggle('active', view === 'hierarchy');
            document.getElementById('departmentView').classList.toggle('active', view === 'departments');
        }

        // ==================== ADMIN PANEL ====================
        let isAdminMode = false;

        function toggleAdminPanel() {
            isAdminMode = !isAdminMode;
            document.getElementById('adminSidebar').classList.toggle('open', isAdminMode);
            document.getElementById('adminToggle').classList.toggle('active', isAdminMode);
            document.querySelectorAll('.employee-card').forEach(card => {
                card.classList.toggle('admin-mode', isAdminMode);
            });
            showToast(isAdminMode ? 'Admin mode enabled' : 'Admin mode disabled', 'info');
        }

        // ==================== STATS ====================
        function updateStats() {
            document.getElementById('totalEmployees').textContent = appData.employees.length;
            document.getElementById('totalDepartments').textContent = appData.departments.length;
        }

        // ==================== EMPLOYEE GRID ====================
        function renderEmployeesGrid() {
            const grid = document.getElementById('employeesGrid');

            if (appData.employees.length === 0) {
                grid.innerHTML = `
                    <div class="empty-state" style="grid-column: 1/-1;">
                        <div class="empty-state-icon">üë•</div>
                        <div class="empty-state-title">No Employees Yet</div>
                        <div class="empty-state-text">Add your first employee to get started</div>
                        <button class="btn btn-primary" onclick="openEmployeeModal()">Add Employee</button>
                    </div>
                `;
                return;
            }

            grid.innerHTML = appData.employees.map(emp => {
                const dept = appData.departments.find(d => d.name === emp.department);
                const manager = appData.employees.find(e => e.id === emp.parentId);
                const deptColor = dept ? dept.color : '#95a5a6';
                const initials = emp.name.split(' ').map(n => n[0]).join('').substring(0, 2);

                return `
                    <div class="employee-card ${isAdminMode ? 'admin-mode' : ''}" style="border-left-color: ${deptColor};" data-id="${emp.id}" data-dept="${emp.department}" data-position="${emp.position}">
                        <div class="card-actions">
                            <button class="card-action-btn edit" onclick="editEmployee(${emp.id})" title="Edit">‚úé</button>
                            <button class="card-action-btn delete" onclick="confirmDeleteEmployee(${emp.id})" title="Delete">√ó</button>
                        </div>
                        <div class="card-header">
                            <div class="card-photo">${initials}</div>
                            <div class="card-info">
                                <div class="card-name">${emp.name}</div>
                                <div class="card-position">${emp.position}</div>
                            </div>
                        </div>
                        <div class="card-details">
                            <div class="card-detail">
                                <span class="card-detail-icon">üè¢</span>
                                <span class="dept-badge" style="background: ${deptColor};">${emp.department}</span>
                            </div>
                            ${manager ? `<div class="card-detail"><span class="card-detail-icon">üë§</span> Reports to: ${manager.name}</div>` : ''}
                            ${emp.shift ? `<div class="card-detail"><span class="card-detail-icon">‚è∞</span> ${emp.shift}</div>` : ''}
                            ${emp.email ? `<div class="card-detail"><span class="card-detail-icon">‚úâ</span> ${emp.email}</div>` : ''}
                        </div>
                    </div>
                `;
            }).join('');
        }

        function filterEmployees() {
            const search = document.getElementById('searchBox').value.toLowerCase();
            const deptFilter = document.getElementById('deptFilter').value;
            const positionFilter = document.getElementById('positionFilter').value;

            document.querySelectorAll('#employeesGrid .employee-card').forEach(card => {
                const name = card.querySelector('.card-name')?.textContent.toLowerCase() || '';
                const dept = card.dataset.dept;
                const position = card.dataset.position;

                const matchesSearch = name.includes(search);
                const matchesDept = !deptFilter || dept === deptFilter;
                const matchesPosition = !positionFilter || position === positionFilter;

                card.style.display = matchesSearch && matchesDept && matchesPosition ? '' : 'none';
            });
        }

        // ==================== HIERARCHY TREE ====================
        function renderHierarchyTree() {
            const container = document.getElementById('hierarchyTree');
            const topLevel = appData.employees.filter(e => !e.parentId);

            if (topLevel.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-state-icon">üå≥</div>
                        <div class="empty-state-title">No Hierarchy Yet</div>
                        <div class="empty-state-text">Add employees to build your organization chart</div>
                    </div>
                `;
                return;
            }

            container.innerHTML = topLevel.map(emp => renderTreeNode(emp, true)).join('');
        }

        function renderTreeNode(employee, isRoot = false) {
            const dept = appData.departments.find(d => d.name === employee.department);
            const deptColor = dept ? dept.color : '#95a5a6';
            const initials = employee.name.split(' ').map(n => n[0]).join('').substring(0, 2);
            const children = appData.employees.filter(e => e.parentId === employee.id);

            return `
                <div class="tree-node ${isRoot ? 'tree-root' : ''}">
                    <div class="tree-card" style="border-left-color: ${deptColor};">
                        <div class="tree-card-photo">${initials}</div>
                        <div class="tree-card-info">
                            <div class="tree-card-name">${employee.name}</div>
                            <div class="tree-card-position">${employee.position} - ${employee.department}</div>
                        </div>
                    </div>
                    ${children.length > 0 ? `
                        <div class="tree-children">
                            ${children.map(child => renderTreeNode(child)).join('')}
                        </div>
                    ` : ''}
                </div>
            `;
        }

        // ==================== DEPARTMENT VIEW ====================
        function renderDepartmentCards() {
            const container = document.getElementById('deptCardsGrid');

            if (appData.departments.length === 0) {
                container.innerHTML = `
                    <div class="empty-state" style="grid-column: 1/-1;">
                        <div class="empty-state-icon">üè¢</div>
                        <div class="empty-state-title">No Departments Yet</div>
                        <div class="empty-state-text">Add departments to organize your team</div>
                        <button class="btn btn-primary" onclick="openDepartmentModal()">Add Department</button>
                    </div>
                `;
                return;
            }

            container.innerHTML = appData.departments.map(dept => {
                const count = appData.employees.filter(e => e.department === dept.name).length;
                return `
                    <div class="dept-card" style="border-top-color: ${dept.color};" onclick="filterByDepartment('${dept.name}')">
                        <div class="dept-card-icon" style="background: ${dept.color};">üè¢</div>
                        <div class="dept-card-name">${dept.name}</div>
                        <div class="dept-card-count">${count} employee${count !== 1 ? 's' : ''}</div>
                    </div>
                `;
            }).join('');
        }

        function filterByDepartment(deptName) {
            document.getElementById('deptFilter').value = deptName;
            switchView('grid');
            filterEmployees();
        }

        // ==================== SIDEBAR DEPT LIST ====================
        function renderDeptList() {
            const container = document.getElementById('deptList');
            container.innerHTML = appData.departments.map(dept => `
                <div class="dept-item">
                    <div class="dept-item-left">
                        <div class="dept-color-dot" style="background: ${dept.color};"></div>
                        <span>${dept.name}</span>
                    </div>
                    <div class="dept-item-actions">
                        <button class="dept-item-btn edit" onclick="editDepartment(${dept.id})" title="Edit">‚úé</button>
                        <button class="dept-item-btn delete" onclick="confirmDeleteDepartment(${dept.id})" title="Delete">√ó</button>
                    </div>
                </div>
            `).join('');
        }

        // ==================== POPULATE SELECTS ====================
        function populateDepartmentSelects() {
            const selects = [document.getElementById('employeeDepartment')];
            selects.forEach(select => {
                const currentValue = select.value;
                select.innerHTML = '<option value="">Select Department</option>' +
                    appData.departments.map(d => `<option value="${d.name}">${d.name}</option>`).join('');
                select.value = currentValue;
            });
        }

        function populateManagerSelect(excludeId = null) {
            const select = document.getElementById('employeeManager');
            const currentValue = select.value;

            const options = appData.employees
                .filter(e => e.id !== excludeId)
                .map(e => `<option value="${e.id}">${e.name} (${e.position})</option>`)
                .join('');

            select.innerHTML = '<option value="">None (Top Level)</option>' + options;
            select.value = currentValue;
        }

        function populateFilterSelects() {
            const deptFilter = document.getElementById('deptFilter');
            const positionFilter = document.getElementById('positionFilter');

            deptFilter.innerHTML = '<option value="">All Departments</option>' +
                appData.departments.map(d => `<option value="${d.name}">${d.name}</option>`).join('');

            const positions = [...new Set(appData.employees.map(e => e.position))];
            positionFilter.innerHTML = '<option value="">All Positions</option>' +
                positions.map(p => `<option value="${p}">${p}</option>`).join('');
        }

        // ==================== EMPLOYEE MODAL ====================
        function openEmployeeModal(employee = null) {
            document.getElementById('employeeModalTitle').textContent = employee ? 'Edit Employee' : 'Add Employee';
            document.getElementById('employeeForm').reset();

            populateDepartmentSelects();
            populateManagerSelect(employee?.id);

            if (employee) {
                document.getElementById('employeeId').value = employee.id;
                document.getElementById('employeeName').value = employee.name;
                document.getElementById('employeePosition').value = employee.position;
                document.getElementById('employeeDepartment').value = employee.department;
                document.getElementById('employeeManager').value = employee.parentId || '';
                document.getElementById('employeeShift').value = employee.shift || '';
                document.getElementById('employeeEmail').value = employee.email || '';
                document.getElementById('employeePhone').value = employee.phone || '';
            } else {
                document.getElementById('employeeId').value = '';
            }

            document.getElementById('employeeModal').classList.add('active');
        }

        function closeEmployeeModal() {
            document.getElementById('employeeModal').classList.remove('active');
        }

        function editEmployee(id) {
            const employee = appData.employees.find(e => e.id === id);
            if (employee) openEmployeeModal(employee);
        }

        function saveEmployee(e) {
            e.preventDefault();

            const id = document.getElementById('employeeId').value;
            const employee = {
                id: id ? parseInt(id) : Date.now(),
                name: document.getElementById('employeeName').value.trim(),
                position: document.getElementById('employeePosition').value.trim(),
                department: document.getElementById('employeeDepartment').value,
                parentId: document.getElementById('employeeManager').value ? parseInt(document.getElementById('employeeManager').value) : null,
                shift: document.getElementById('employeeShift').value.trim(),
                email: document.getElementById('employeeEmail').value.trim(),
                phone: document.getElementById('employeePhone').value.trim()
            };

            if (id) {
                const index = appData.employees.findIndex(e => e.id === parseInt(id));
                if (index !== -1) appData.employees[index] = employee;
                showToast('Employee updated successfully', 'success');
            } else {
                appData.employees.push(employee);
                showToast('Employee added successfully', 'success');
            }

            saveData();
            renderAll();
            closeEmployeeModal();
        }

        function confirmDeleteEmployee(id) {
            const employee = appData.employees.find(e => e.id === id);
            if (!employee) return;

            const hasReports = appData.employees.some(e => e.parentId === id);

            document.getElementById('confirmTitle').textContent = 'Delete Employee';
            document.getElementById('confirmMessage').textContent = hasReports
                ? `Are you sure you want to delete ${employee.name}? This employee has direct reports who will become top-level.`
                : `Are you sure you want to delete ${employee.name}?`;
            document.getElementById('confirmIcon').textContent = '‚ö†Ô∏è';
            document.getElementById('confirmBtn').onclick = () => deleteEmployee(id);
            document.getElementById('confirmModal').classList.add('active');
        }

        function deleteEmployee(id) {
            // Remove parent reference from reports
            appData.employees.forEach(e => {
                if (e.parentId === id) e.parentId = null;
            });

            appData.employees = appData.employees.filter(e => e.id !== id);
            saveData();
            renderAll();
            closeConfirmModal();
            showToast('Employee deleted', 'success');
        }

        // ==================== DEPARTMENT MODAL ====================
        function openDepartmentModal(department = null) {
            document.getElementById('departmentModalTitle').textContent = department ? 'Edit Department' : 'Add Department';
            document.getElementById('departmentForm').reset();

            if (department) {
                document.getElementById('departmentId').value = department.id;
                document.getElementById('departmentName').value = department.name;
                document.getElementById('departmentColor').value = department.color;
                document.getElementById('departmentDescription').value = department.description || '';
            } else {
                document.getElementById('departmentId').value = '';
                document.getElementById('departmentColor').value = '#3498db';
            }

            updateColorPreview();
            document.getElementById('departmentModal').classList.add('active');
        }

        function closeDepartmentModal() {
            document.getElementById('departmentModal').classList.remove('active');
        }

        function editDepartment(id) {
            const department = appData.departments.find(d => d.id === id);
            if (department) openDepartmentModal(department);
        }

        function updateColorPreview() {
            const color = document.getElementById('departmentColor').value;
            document.getElementById('colorPreview').style.background = color;
        }

        function saveDepartment(e) {
            e.preventDefault();

            const id = document.getElementById('departmentId').value;
            const oldName = id ? appData.departments.find(d => d.id === parseInt(id))?.name : null;

            const department = {
                id: id ? parseInt(id) : Date.now(),
                name: document.getElementById('departmentName').value.trim(),
                color: document.getElementById('departmentColor').value,
                description: document.getElementById('departmentDescription').value.trim()
            };

            if (id) {
                const index = appData.departments.findIndex(d => d.id === parseInt(id));
                if (index !== -1) {
                    appData.departments[index] = department;
                    // Update employees with old department name
                    if (oldName && oldName !== department.name) {
                        appData.employees.forEach(e => {
                            if (e.department === oldName) e.department = department.name;
                        });
                    }
                }
                showToast('Department updated successfully', 'success');
            } else {
                appData.departments.push(department);
                showToast('Department added successfully', 'success');
            }

            saveData();
            renderAll();
            closeDepartmentModal();
        }

        function confirmDeleteDepartment(id) {
            const department = appData.departments.find(d => d.id === id);
            if (!department) return;

            const employeeCount = appData.employees.filter(e => e.department === department.name).length;

            document.getElementById('confirmTitle').textContent = 'Delete Department';
            document.getElementById('confirmMessage').textContent = employeeCount > 0
                ? `Are you sure you want to delete ${department.name}? ${employeeCount} employee(s) in this department will have no department.`
                : `Are you sure you want to delete ${department.name}?`;
            document.getElementById('confirmIcon').textContent = '‚ö†Ô∏è';
            document.getElementById('confirmBtn').onclick = () => deleteDepartment(id);
            document.getElementById('confirmModal').classList.add('active');
        }

        function deleteDepartment(id) {
            const department = appData.departments.find(d => d.id === id);
            if (department) {
                // Clear department from employees
                appData.employees.forEach(e => {
                    if (e.department === department.name) e.department = '';
                });
            }

            appData.departments = appData.departments.filter(d => d.id !== id);
            saveData();
            renderAll();
            closeConfirmModal();
            showToast('Department deleted', 'success');
        }

        // ==================== SETTINGS MODAL ====================
        function openSettingsModal() {
            document.getElementById('settingsCompanyName').value = appData.settings.companyName;
            document.getElementById('settingsPositions').value = appData.settings.positionLevels.join(', ');
            document.getElementById('settingsModal').classList.add('active');
        }

        function closeSettingsModal() {
            document.getElementById('settingsModal').classList.remove('active');
        }

        function saveSettings(e) {
            e.preventDefault();

            appData.settings.companyName = document.getElementById('settingsCompanyName').value.trim() || 'Employee Board';
            appData.settings.positionLevels = document.getElementById('settingsPositions').value
                .split(',')
                .map(p => p.trim())
                .filter(p => p);

            document.getElementById('companyName').textContent = appData.settings.companyName;

            saveData();
            closeSettingsModal();
            showToast('Settings saved successfully', 'success');
        }

        // ==================== CONFIRM MODAL ====================
        function closeConfirmModal() {
            document.getElementById('confirmModal').classList.remove('active');
        }

        function confirmReset() {
            document.getElementById('confirmTitle').textContent = 'Reset All Data';
            document.getElementById('confirmMessage').textContent = 'This will reset all data to default. This action cannot be undone. Are you sure?';
            document.getElementById('confirmIcon').textContent = 'üîÑ';
            document.getElementById('confirmBtn').onclick = resetData;
            document.getElementById('confirmModal').classList.add('active');
        }

        function resetData() {
            appData = JSON.parse(JSON.stringify(defaultData));
            saveData();
            document.getElementById('companyName').textContent = appData.settings.companyName;
            renderAll();
            closeConfirmModal();
            showToast('Data reset to default', 'success');
        }

        // ==================== IMPORT/EXPORT ====================
        function exportData() {
            const dataStr = JSON.stringify(appData, null, 2);
            const blob = new Blob([dataStr], { type: 'application/json' });
            const url = URL.createObjectURL(blob);

            const a = document.createElement('a');
            a.href = url;
            a.download = `employee-board-${new Date().toISOString().split('T')[0]}.json`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);

            showToast('Data exported successfully', 'success');
        }

        function importData(event) {
            const file = event.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = (e) => {
                try {
                    const imported = JSON.parse(e.target.result);

                    // Validate structure
                    if (!imported.departments || !imported.employees) {
                        throw new Error('Invalid data structure');
                    }

                    appData = {
                        settings: imported.settings || defaultData.settings,
                        departments: imported.departments,
                        employees: imported.employees
                    };

                    saveData();
                    document.getElementById('companyName').textContent = appData.settings.companyName;
                    renderAll();
                    showToast('Data imported successfully', 'success');
                } catch (err) {
                    showToast('Error importing data: Invalid file format', 'error');
                }
            };
            reader.readAsText(file);
            event.target.value = '';
        }

        // ==================== TOAST NOTIFICATIONS ====================
        function showToast(message, type = 'info') {
            const container = document.getElementById('toastContainer');
            const toast = document.createElement('div');
            toast.className = `toast ${type}`;
            toast.innerHTML = `<span>${type === 'success' ? '‚úì' : type === 'error' ? '‚úó' : '‚Ñπ'}</span> ${message}`;
            container.appendChild(toast);

            setTimeout(() => {
                toast.style.opacity = '0';
                toast.style.transform = 'translateX(100%)';
                setTimeout(() => toast.remove(), 300);
            }, 3000);
        }

        // ==================== INITIALIZE APP ====================
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>
